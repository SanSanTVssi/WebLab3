@{
    ViewData["Title"] = "Write post";
}
<h1>@ViewData["Title"]</h1>
<div class="container flex-grow-1 my-4">
    <form method="post" action="@Url.Action("CreatePost", "Posts")">
        <div class="form-group mb-3">
            <label for="post-title" class="form-label fw-bold">Title</label>
            <input type="text" class="form-control" id="post-title" name="Title" placeholder="Enter title">
        </div>
        <div class="form-group mb-3">
            <label for="post-image" class="form-label fw-bold">Image Link</label>
            <input type="text" class="form-control" id="post-image" name="ImageLink" placeholder="Enter image link">
        </div>
        <div class="form-group mb-3">
            <label for="post-description" class="form-label fw-bold">Description</label>
            <textarea class="form-control" id="post-description" name="Description" rows="3" placeholder="Enter post description"></textarea>
        </div>
        <div class="form-group mb-3">
            <label for="post-body" class="form-label fw-bold">Body</label>
            <textarea class="form-control" id="post-body" name="Body" rows="10" placeholder="Enter post body"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function () {
    $('form').submit(function (e) {
        e.preventDefault();

        $.ajax({
            url: '@Url.Action("CreatePost", "Posts")',
            type: 'POST',
            data: $(this).serialize(),
            success: function (result) {
                if (result === "") {
                    alert('Post created successfully');
                    window.top.location.href = '/Home/Index';
                } else {
                    alert("Error! " + result.error);
                }
            },
            error: function (xhr, status, error) {
                if (xhr.responseJSON && xhr.responseJSON.error) {
                    alert("Error! " + xhr.responseJSON.error);
                } else {
                    alert('An error occurred');
                }
            }
        });
    });
});

</script>
